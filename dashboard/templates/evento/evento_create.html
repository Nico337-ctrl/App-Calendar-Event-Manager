{% extends 'layouts/base_dashboard.html' %}
{% block content %}
<div class="form-container">
    <h2>Crear evento</h2>
    <form action="{% url 'evento_create' %}" method="POST">
        {% csrf_token %}
        <div class="form-group">
            <label for="titulo">Titulo</label>
            {{ formulario.titulo }}
        </div>
        <div class="form-group">
            <label for="email">Descripcion</label>
            {{ formulario.descripcion }}
        </div>
        <div class="form-group">
            <label for="budget">Informacion extra</label>
            {{ formulario.info_extra }}
        </div>
        <div class="form-group">
            <label for="message">Inicia</label>
            {{ formulario.inicia_el }}
        </div>
        <div class="form-group">
            <label for="message">Termina</label>
            {{ formulario.termina_el }}
        </div>
        <div class="form-group">
            <label for="message">Etiqueta</label>
            {{ formulario.etiqueta }}
        </div>
        <div class="form-group">
            <label for="message">¿Notificar?</label>
            {{ formulario.notificar }}
        </div>
        <button type="submit" id="editLink">Guardar</button>
        <a href="{% url 'evento_etiqueta' %}" id="eliminarLink">Cancelar</a>
    </form>
</div>

<style>
    .form-container {
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
    }
    
    .form-container h2 {
        font-size: 24px;
        margin-bottom: 20px;
        font-weight: 700;
        color: #333;
    }
    
    .form-group {
        margin-bottom: 20px;
    }
    
    .form-group label {
        display: block;
        font-size: 14px;
        margin-bottom: 5px;
        color: #666;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
        width: 100%;
        padding: 10px;
        font-size: 14px;
        border-radius: 4px;
        border: 1px solid #ddd;
        color: #333;
    }
    
    .form-group textarea {
        resize: vertical;
    }
    
    .btn-submit {
        display: inline-block;
        padding: 10px 20px;
        font-size: 16px;
        color: #fff;
        background-color: #29a900;
        border: none;
        border-radius: 50px;
        cursor: pointer;
        transition: background-color 0.3s ease;
        box-shadow: 0px 1px 3px rgbargba(57, 169, 0, 0.5);
    }
    
    .btn-submit:hover {
        background-color: #29c900;
    }
</style>

<script>
    // Obtener las opciones predefinidas desde los campos ocultos del formulario
    const usuarios = {{ formulario.correos_usuarios | safe }};
    const rolesAgrupados = {{ formulario.correos_rol_agrupado | safe }};
    const correosPorRol = {{ formulario.correos_por_rol | safe }};

    function actualizarOpciones() {
        var filtroSelect = document.getElementById('filtro_select');
        var opcionesSelect = document.getElementById('opciones_select');
        
        // Limpiar el campo de opciones
        opcionesSelect.innerHTML = '';

        // Determinar el tipo de filtro seleccionado
        var filtroSeleccionado = filtroSelect.value;

        if (filtroSeleccionado === 'usuarios') {
            // Agregar las opciones de todos los usuarios
            usuarios.forEach(function(correo) {
                var option = new Option(correo, correo);
                opcionesSelect.add(option);
            });
        } else if (filtroSeleccionado === 'rol_agrupado') {
            // Agregar las opciones agrupadas por rol
            for (var rol in rolesAgrupados) {
                var option = new Option(rol, rolesAgrupados[rol]);
                opcionesSelect.add(option);
            }
        } else if (filtroSeleccionado === 'rol') {
            // Agregar opciones de correos por rol
            correosPorRol.forEach(function(rol) {
                var option = new Option(rol, rol);
                opcionesSelect.add(option);
            });
        }
    }

    // Ejecutar cuando el documento esté listo
    document.addEventListener('DOMContentLoaded', function() {
        actualizarOpciones();
    });
</script>

{% endblock %}
